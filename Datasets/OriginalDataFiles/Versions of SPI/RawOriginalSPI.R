###############################
# This script inputs
# reshapes and rescales
# Lora's original aggregated 
# SPI index and saves
# a copy in McGannModel/SPI
#
# SO: Jan. 5, 2015
###############################
library(reshape)

# This is the Index of Structural Reform, organized by country-years, from Lora 2012
spi <- matrix(c(0.40,0.39,0.43,0.41,0.45,0.49,0.30,0.31,0.32,0.54,0.59,0.59,0.35,0.45,0.45,0.38,0.47,0.51,0.34,0.33,0.34,0.34,0.36,0.36,0.37,0.39,0.39,0.38,0.38,0.44,0.38,0.38,0.38,0.45,0.47f,0.55,0.35,0.36,0.40,0.30,0.30,0.41,0.42,0.42,0.41,0.28,0.30,0.31,0.61,0.65,0.65,0.47,0.45,0.45,0.34,0.33,0.33,0.38,0.41,0.43,0.42,0.41,0.52,0.52,0.38,0.45,0.62,0.62,0.45,0.45,0.51,0.50,0.33,0.34,0.34,0.36,0.39,0.40,0.46,0.49,0.38,0.43,0.55,0.55,0.42,0.48,0.26,0.29,0.41,0.43,0.30,0.30,0.67,0.67,0.47,0.46,0.33,0.35,0.44,0.45,0.50,0.53,0.57,0.59,0.52,0.55,0.55,0.58,0.43,0.46,0.49,0.51,0.62,0.62,0.62,0.62,0.48,0.57,0.58,0.54,0.51,0.50,0.51,0.52,0.42,0.46,0.51,0.50,0.44,0.44,0.53,0.54,0.43,0.43,0.48,0.51,0.52,0.53,0.53,0.54,0.40,0.39,0.45,0.46,0.57,0.60,0.63,0.64,0.50,0.51,0.52,0.53,0.43,0.30,0.36,0.41,0.49,0.52,0.53,0.56,0.40,0.42,0.48,0.51,0.70,0.68,0.68,0.70,0.47,0.48,0.51,0.50,0.41,0.45,0.46,0.50,0.49,0.51,0.53,0.55,0.59,0.60,0.58,0.56,0.52,0.52,0.63,0.64,0.57,0.58,0.52,0.54,0.52,0.52,0.54,0.54,0.52,0.54,0.55,0.55,0.46,0.55,0.65,0.66,0.53,0.53,0.49,0.49,0.57,0.57,0.54,0.55,0.68,0.70,0.51,0.52,0.46,0.50,0.55,0.56,0.61,0.62,0.62,0.63,0.63,0.57,0.60,0.71,0.73,0.71,0.55,0.55,0.57,0.56,0.57,0.65,0.69,0.70,0.72,0.73,0.58,0.59,0.59,0.58,0.59,0.51,0.52,0.54,0.54,0.56,0.53,0.54,0.53,0.58,0.58,0.54,0.54,0.55,0.50,0.52,0.54,0.53,0.57,0.60,0.61,0.55,0.53,0.56,0.58,0.59,0.56,0.56,0.60,0.59,0.60,0.66,0.65,0.65,0.69,0.70,0.50,0.52,0.52,0.52,0.52,0.56,0.57,0.56,0.57,0.60,0.57,0.57,0.57,0.57,0.57,0.59,0.59,0.62,0.63,0.64,0.70,0.67,0.66,0.69,0.69,0.53,0.53,0.53,0.53,0.54,0.56,0.56,0.57,0.55,0.56,0.57,0.57,0.59,0.59,0.60,0.60,0.61,0.74,0.75,0.58,0.61,0.75,0.76,0.58,0.58,0.56,0.57,0.61,0.64,0.60,0.60,0.61,0.62,0.59,0.64,0.61,0.61,0.71,0.72,0.55,0.54,0.59,0.60,0.57,0.57,0.64,0.64,0.71,0.71,0.54,0.57,0.58,0.53,0.61,0.62,0.62,0.63,0.76,0.76,0.62,0.62,0.76,0.77,0.59,0.59,0.56,0.56,0.62,0.62,0.60,0.60,0.62,0.62,0.65,0.64,0.62,0.63,0.74,0.74,0.55,0.55,0.60,0.61,0.57,0.63,0.65,0.65,0.71,0.72,0.57,0.57,0.54,0.57,0.63,0.63,0.64,0.64,0.77,0.78,0.63,0.63,0.78,0.79,0.59,0.62,0.57,0.56,0.61,0.61,0.56,0.57,0.63,0.63,0.65,0.65,0.63,0.66,0.74,0.74,0.56,0.58,0.61,0.64,0.65,0.68,0.65,0.66,0.74,0.74,0.57,0.57,0.58,0.60,0.64,0.65,0.64,0.65,0.65,0.78,0.79,0.78,0.64,0.66,0.66,0.80,0.80,0.80,0.62,0.63,0.63,0.57,0.57,0.56,0.62,0.62,0.62,0.57,0.56,0.59,0.65,0.64,0.64,0.66,0.66,0.66,0.66,0.67,0.67,0.74,0.74,0.75,0.58,0.52,0.53,0.65,0.68,0.67,0.66,0.66,0.68,0.67,0.68,0.69,0.73,0.77,0.78,0.56,0.56,0.56,0.58,0.59,0.62,0.65,0.65,0.65)
              ,ncol=25,byrow=TRUE)
countries <- c("Argentina","Bolivia","Brasil","Chile","Colombia","CostaRica","RepublicaDominicana","Ecuador","ElSalvador","Guatemala","Honduras","Jamaica","Mexico","Nicaragua","Paraguay","Peru","TrinidadandTobago","Uruguay","Venezuela","RegionalAverage")
spi <- data.frame(cnty=countries,spi)
names(spi)[-1] <- 1985:2009

spi <- melt(spi,id="cnty")
names(spi) <- c("Pais","Year","spi")
#spi$spi <- scale(spi$spi)

rescale <- function(x,mi,ma){
  obs.min <- min(x)
  obs.max <- max(x)
  (ma-mi)/(obs.max-obs.min)*(x-obs.max)+ma 
}
spi$spi <- rescale(spi$spi,-1,1)

write.csv(spi,"~/Dropbox/Chain of Responsiveness/McGannModel/SPI/OriginalSPI.csv"
          ,row.names=FALSE)
